sets
i        aircrafts /1*20/
j        trajectory    /1*3/
k        set of capacited structure(control sector or airports) /1*10/
l        set of connected flights /1*9/
JI(i,j)  assigning aircrafts to trajectory /(1*20).(1*3)/
CF(i,l)  set of connected flights to flight f /(1.1),(2.2),(3.3),(4.4),(5.5),(6.6),(7.7),(8.8),(9.9)/
p        time periods /1*10/                                        ;



table c(i,j) total cost of trajectory j for flight i

             1                 2               3

1            145              180              190
2            90               135              200
3            200              210              230
4            250              260              270
5            350              380              410
6            142              230              246
7            400              420              430
8            260              280              290
9            200              210              250
10           250              260              270
11           350              380              410
12           180              198              200
13           400              420              430
14           260              280              290
15           200              250              230
16           250              260              270
17           350              380              410
18           290              410              576
19           350              380              410
20           134              210              200

;

table CD(i,j,p) cost of airborne delay imposed on delayed flights
           1     2          3          4          5           6           7           8           9           10
1.1        0     145        290        435        580         725         870         1015        1160        1305
1.2        0     180        360        540        720         900         1080        1260        1440        1620
1.3        0     190        380        570        760         950         1140        1330        1520        1710
2.1        0     90         180        270        360         450         540         630         720         810
2.2        0     135        270        405        540         675         810         945         1080        1215
3.1        0     200        400        600        800         1000        1200        1400        1600        1800
3.2        0     210        420        630        840         1050        1260        1470        1680        1890
3.3        0     230        460        690        920         1150        1380        1610        1840        2070
4.1        0     250        500        750        1000        1250        1500        1750        2000        2250
4.2        0     260        520        780        1040        1300        1560        1820        2080        2340
4.3        0     270        540        810        1080        1350        1620        1890        2160        2430
5.1        0     350        700        1050       1400        1750        2100        2450        2800        3150
5.2        0     380        760        1140       1520        1900        2280        2660        3040        3420
5.3        0     410        820        1230       1640        2050        2460        2870        3280        3690
6.1        0     142        284        426        568         710         852         994         1136        1278
6.2        0     230        460        690        920         1150        1380        1610        1840        2070
6.3        0     246        492        738        984         1230        1476        1722        1968        2214
7.1        0     400        800        1200       1600        2000        2400        2800        3200        3600
7.2        0     420        840        1260       1680        2100        2520        2940        3360        3780
7.3        0     430        860        1290       1720        2150        2580        3010        3440        3870
8.1        0     260        520        780        1040        1300        1560        1820        2080        2340
8.2        0     280        560        840        1120        1400        1680        1960        2240        2520
8.3        0     290        580        870        1160        1450        1740        2030        2320        2610
9.1        0     200        400        600        800         1000        1200        1400        1600        1800
9.2        0     210        420        630        840         1050        1260        1470        1680        1890
9.3        0     250        500        750        1000        1250        1500        1750        2000        2250
10.1       0     250        500        750        1000        1250        1500        1750        2000        2250
10.2       0     260        520        780        1040        1300        1560        1820        2080        2340
10.3       0     270        540        810        1080        1350        1620        1890        2160        2430
11.1       0     350        700        1050       1400        1750        2100        2450        2800        3150
11.2       0     380        760        1140       1520        1900        2280        2660        3040        3420
11.3       0     410        820        123        1640        2050        2460        2870        3280        3690
12.1       0     180        360        540        720         900         1080        1260        1440        1620
12.2       0     198        396        594        792         990         1188        1386        1584        1782
12.3       0     200        400        600        800         1000        1200        1400        1600        1800
13.1       0     400        800        1200       1600        2000        2400        2800        3200        3600
13.2       0     420        840        1260       1680        2100        2520        2940        3360        3780
13.3       0     430        860        1290       1720        2150        2580        3010        3440        3870
14.1       0     260        520        780        1040        1300        1560        1820        2080        2340
14.2       0     280        560        840        1120        1400        1680        1960        2240        2520
14.3       0     290        580        870        1160        1450        1740        2030        2320        2610
15.1       0     200        400        600        800         1000        1200        1400        1600        1800
15.2       0     250        500        750        1000        1250        1500        1750        2000        2250
15.3       0     270        540        810        1080        1350        1620        1890        2160        2430
16.1       0     250        500        750        1000        1250        1500        1750        2000        2250
16.2       0     260        520        780        1040        1300        1560        1820        2080        2340
16.3       0     270        540        810        1080        1350        1620        1890        2160        2430
17.1       0     350        700        1050       1400        1750        2100        2450        2800        3150
17.2       0     380        760        1140       1520        1900        2280        2660        3040        3420
17.3       0     410        820        1230       1640        2050        2460        2870        3280        3690
18.1       0     290        580        870        1160        1450        1740        2030        2320        2610
18.2       0     410        820        1230       1640        2050        2460        2870        3280        3690
18.3       0     576        1152       1728       2304        2880        3456        4032        4608        5184
19.1       0     350        700        1050       1400        1750        2100        2450        2800        3150
19.2       0     380        760        1140       1520        1900        2280        2660        3040        3420
19.3       0     410        820        1230       1640        2050        2460        2870        3280        3690
20.1       0     134        268        402        536         670         804         938         1072        1206
20.2       0     210        420        630        840         1050        1260        1470        1680        1890
20.3       0     300        600        900        1200        1500        1800        2100        2400        2700
;
table cg(i,l)    cost of connect flight delay
         1       2       3        4      5       6       7       8       9

1        65
2                64
3                        66
4                                67
5                                        63
6                                                62
7                                                        65
8                                                                61
9                                                                        60
;


table CS(k,p) capacity of capacited structure during period p

         1       2      3      4      5      6      7      8      9      10
1        2       2      2      2      2      2      2      2      2      2
2        4       4      4      4      4      4      4      4      4      4
3        4       4      4      4      4      4      4      4      4      4
4        4       4      4      4      4      4      4      4      4      4
5        4       4      4      4      4      4      4      4      4      4
6        4       4      4      4      4      4      4      4      4      4
7        4       4      4      4      4      4      4      4      4      4
8        4       4      4      4      4      4      4      4      4      4
9        4       4      4      4      4      4      4      4      4      4
10       4       4      4      4      4      4      4      4      4      4

;


table a(i,l) arrival time of flight i by trajectory j

         1       2       3        4      5       6       7       8       9

1        24
2                24
3                        24
4                                24
5                                        24
6                                                24
7                                                        24
8                                                                24
9                                                                        24
;




table d(i,l) departure time of  flight l connected to flight i

         1       2       3        4      5       6       7       8       9

1        34
2                32
3                        36
4                                34
5                                        46
6                                                46
7                                                        29
8                                                                53
9                                                                        53
;

table t(i,l) turnover time between flight i and l

         1       2       3        4      5       6       7       8       9

1        40
2                40
3                        40
4                                 40
5                                        40
6                                                40
7                                                        40
8                                                                40
9                                                                        40
;

variable
r(i,l)
y(i,j,k,p)
x(i,j,p)
z
w(i,j,k,p)

      ;
positive variables
r(i,l)

;

BINARY VARIABLEs
y(i,j,k,p)
x(i,j,p)
w(i,j,k,p)
;

equations
cost
capcon(p)
delpcon(i,j,l,p)
unicony1(i)
unicony2(j,p)

;
*objective function
cost.. z =e= (sum((i,j,p),(c(i,j)+CD(i,j,p))*y(i,j,'1',p))) + sum((i,l)$CF(i,l),cg(i,l)*r(i,l));

*unique constraints
unicony2(j,p).. sum(i,y(i,j,'1',p)) =l= 1        ;
unicony1(i).. sum((j,p), y(i,j,'1',p)) =e= 1        ;

*capacity constraint
capcon(p) .. sum((i,j)$JI(i,j),y(i,j,'1',p)) =l= CS('1',p) ;

*cost of air borne delay
delpcon(i,j,l,p)$CF(i,l)..  a(i,l)+ 3*y(i,j,'1',p)*(ord(p)-1)-r(i,l) =l= (d(i,l)-t(i,l));

model atcfinal23 /all/;

solve atcfinal23 using MIP minimizing z;

display z.l, r.l, y.l;
